## 第一章

### 术语挑选

- **虚拟机**：用软件实现的机器。

- **翻译、解释**

- **计算机系统结构**：传统机器程序员所看到的计算机属性，即概念性结构与功能特性。

- **透明性**：在计算机技术中，把这种本来存在的事物或属性，但从某种角度看又好像不存在的概念称为透明性。

- **计算机组成**：计算机系统结构的逻辑实现，包含物理机器级中的数据流和控制流的组成以及逻辑设计等。着眼于物理机器级內**各事件的排序方式和控制方式、各部件的功能和部件之间的联系**

- **计算机实现**：计算机组成的物理实现。着眼于**器件**和**微组装技术**。

- **Amdahl定律**：当对一个系统中的某个部件进行改进后，所能获得的整个系统性能的提高，受限于该部件的执行时间占总执行时间的百分比。

- **系列机**：由同一厂家生产的具有相同系统结构、但具有不同组成和实现的一系列不同型号的计算机。

- **模拟**，**仿真**

- **并行性**：计算机系统在同一时刻或者同一时间间隔内进行多种运算或操作。只要在时间上相互重叠，就存在并行性。它包括同时性与并发性两种含义。

  - **时间重叠**：在并行性概念中引入<u>时间因素</u>，让多个处理过程在时间上相互错开，轮流重叠地使用同一套硬件设备的各个部分，以加快硬件周转而赢得速度。

    **资源重复**：在并行性概念中引入<u>空间因素</u>，以数量取胜。通过重复设置硬件资源，大幅度地提高计算机系统的性能。

    **资源共享**：这是一种软件方法，它使多个任务按一定时间顺序轮流使用同一套硬件设备。

- **异构型多处理机系统**：由多个不同类型、至少担负不同功能的处理机组成，它们按照作业要求的顺序，利用时间重叠原理，依次对它们的多个任务进行加工，各自完成规定的功能动作。

  **同构型多处理机系统**：由多个同类型或至少担负同等功能的处理机组成，它们同时处理同一作业中能并行执行的多个任务。



### 1.1

2002年后，计算机性能下降的原因：

- 功耗问题
- 可开发的指令集并行性很少
- 存储器访问速度提升缓慢

因而-> **多核**， 开发**线程级并行** 和 **数据集并行**



### 1.2 系统结构概念

按照**计算机语言**的角度->计算机系统按功能划分成 **多级层次结构**，每一层以一种语言为特征。

按照计算机系统的多级层次结构，不同级程序员看到的计算机具有不同的属性。

**广义的系统结构定义**：指令集结构、组成、硬件

- 传统机器语言级程序员看到的属性：
  - 指令系统、数据表示、寻址规则、寄存器定义、终端系统、工作转台的定义和切换、存储系统、信息保护、IO结构

计算机系统结构概念的**实质**：确定软、硬件的界面

**计算机组成、实现**：一种体系结构可以有多种组成，一种组成可以有多种物理实现。

计算机系统结构的**分类**：

- Flynn：**指令流**和**数据流**的多倍性进行分类

  指令流：计算机执行的指令序列。

  数据流：由指令条用的数据序列

  多倍性：在系统受限的部件下，同时处于同一执行阶段的指令和数据的最大数目。

  - SISD SIMD MISD MIMD

- 冯氏：系统最大并行度（m*n）



### 1.3 定量分析技术

4个定量原理：

1. 经常性时间为重点。

   对经常发生的情况采用优化方法的原则进行选择，得到更多总体上的改进。

   **优化**：分配更多资源、达到更高性能或者分配更多的电能？

2. Amdahl定律

   加快某部件的执行速度对于系统总体性能的提升，受限于该部件执行时间占总执行时间的百分比。

   概念：加速比、可改进比例 \< 1、部件加速比 \>1

   **一种性能改进的递减规则**

   **重要推论**：如果只针对整个任务的一部分进行改进和优化，那么所获得的加速比不超过
   $$

   $$

   $$
   \frac{1}{1-可改进比例}
   $$




3. CPU性能公式

   CPU时间 = IC * CPI * 时钟周期时间

   CPU时钟周期数 = $\sum (CPI_i \times IC_i)$

   **CPI = $\sum (CPI_i \times \frac{IC_i}{IC})$**

4. 程序的局部性原理

   程序执行时所访问的存储器地址分布不是随机

   的，而是相对地簇聚

   - 时间局部性
   - 空间局部性

性能评测：

1. 执行时间：

   - 全部时间
   - CPU时间：CPU执行所给定的程序所花费的时间，不包含I/O等待时间以及运行其他程序的时间。
     - 用户CPU时间
     - 系统CPU时间：用户程序运行期间操作系统耗费的CPU时间

   吞吐率：单位时间的任务量

2. 基准测试程序

   基准测试程序套件: SPEC系列

   事务处理性能测试基准程序（TP）



### 1.4 发展

冯诺依曼结构：

1. 存储程序原理的**基本点**：**指令驱动**
2. 主要特点：
   - 以运算器为中心
   - 在存储器中，指令和数据同等对待
   - 存储器是按地址访问、按顺序线性编址的一堆结构，每个单元的位数是固定的
   - 指令执行顺序
   - 指令=操作码+地址码
   - 二进制表示、运算
3. 改进
   - 输入输出方式：
     - 程序控制：等待、中断
     - DMA
     - IO处理机
   - 并行处理
   - 存储器
   - 指令集

软件的可移植性：

- 系列机

  **向后兼容**是系列机的**根本特征**。

- 模拟、仿真

- 统一高级语言

摩尔定律：集成电路芯片晶体管数 18个月翻番

**应用需求** 是 促使计算机系统结构发展的最根本的**动力**

计算机性能随时间下移



### 1.5 并行性

并行性：计算机系统在同一时刻或同一时间间隔内进行多种运算或操作。

- 同时性：时刻
- 并发行：时间间隔

处理数据的角度：字串位串->全并行（字并位并）

执行程序的角度：指令内部、指令级、现成绩、任务级、作业级

- 三种途径：

  - 时间重叠（主导作用）

    - 部件功能专用化->流水线

  - 资源重复

    - 多提存储器
    - 多操作部件->指令集并行

  - 资源共享

    单处理机模拟多处理机的功能（虚拟机）

    - 分时系统

3种多处理机：

- 异构型多处理机

  不用类型、至少担负不同功能的处理机组成，按照要求的顺序，**利用时间重叠原理**，多个任务进行加工，完成**各自功能**。

- 同构性多处理机

  同类型，至少担负同种功能的，同时处理统一作业中能并行的多个任务。

- 分布式系统